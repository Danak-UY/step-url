#!/usr/bin/env node

// Required parameters:
// @raycast.schemaVersion 1
// @raycast.title Open Url
// @raycast.mode silent

// Optional parameters:
// @raycast.icon ðŸ¤–
// @raycast.argument1 { "type": "text", "placeholder": "Url path" }

// Documentation:
// @raycast.author mcaldera

(()=>{var e={906:e=>{"use strict";e.exports=(e,r,t)=>{const o=t=>Object.defineProperty(e,r,{value:t,enumerable:!0,writable:!0});return Object.defineProperty(e,r,{configurable:!0,enumerable:!0,get(){const e=t();return o(e),e},set(e){o(e)}}),e}},595:(e,r,t)=>{"use strict";const o=t(147);let s;e.exports=()=>(void 0===s&&(s=function(){try{return o.statSync("/.dockerenv"),!0}catch(e){return!1}}()||function(){try{return o.readFileSync("/proc/self/cgroup","utf8").includes("docker")}catch(e){return!1}}()),s)},818:(e,r,t)=>{"use strict";const o=t(37),s=t(147),n=t(595),i=()=>{if("linux"!==process.platform)return!1;if(o.release().toLowerCase().includes("microsoft"))return!n();try{return!!s.readFileSync("/proc/version","utf8").toLowerCase().includes("microsoft")&&!n()}catch(e){return!1}};process.env.__IS_WSL_TEST__?e.exports=i:e.exports=i()},318:(e,r,t)=>{const o=t(17),s=t(81),{promises:n,constants:i}=t(147),a=t(818),c=t(595),u=t(906),p=o.join(__dirname,"xdg-open"),{platform:l,arch:w}=process,f=(()=>{const e="/mnt/";let r;return async function(){if(r)return r;const t="/etc/wsl.conf";let o=!1;try{await n.access(t,i.F_OK),o=!0}catch{}if(!o)return e;const s=await n.readFile(t,{encoding:"utf8"}),a=/(?<!#.*)root\s*=\s*(?<mountPoint>.*)/g.exec(s);return a?(r=a.groups.mountPoint.trim(),r=r.endsWith("/")?r:`${r}/`,r):e}})(),g=async(e,r)=>{let t;for(const o of e)try{return await r(o)}catch(e){t=e}throw t},m=async e=>{if(e={wait:!1,background:!1,newInstance:!1,allowNonzeroExitCode:!1,...e},Array.isArray(e.app))return g(e.app,(r=>m({...e,app:r})));let r,{name:t,arguments:o=[]}=e.app||{};if(o=[...o],Array.isArray(t))return g(t,(r=>m({...e,app:{name:r,arguments:o}})));const u=[],w={};if("darwin"===l)r="open",e.wait&&u.push("--wait-apps"),e.background&&u.push("--background"),e.newInstance&&u.push("--new"),t&&u.push("-a",t);else if("win32"===l||a&&!c()){const s=await f();r=a?`${s}c/Windows/System32/WindowsPowerShell/v1.0/powershell.exe`:`${process.env.SYSTEMROOT}\\System32\\WindowsPowerShell\\v1.0\\powershell`,u.push("-NoProfile","-NonInteractive","â€“ExecutionPolicy","Bypass","-EncodedCommand"),a||(w.windowsVerbatimArguments=!0);const n=["Start"];e.wait&&n.push("-Wait"),t?(n.push(`"\`"${t}\`""`,"-ArgumentList"),e.target&&o.unshift(e.target)):e.target&&n.push(`"${e.target}"`),o.length>0&&(o=o.map((e=>`"\`"${e}\`""`)),n.push(o.join(","))),e.target=Buffer.from(n.join(" "),"utf16le").toString("base64")}else{if(t)r=t;else{const e="/"===__dirname;let t=!1;try{await n.access(p,i.X_OK),t=!0}catch{}r=process.versions.electron||"android"===l||e||!t?"xdg-open":p}o.length>0&&u.push(...o),e.wait||(w.stdio="ignore",w.detached=!0)}e.target&&u.push(e.target),"darwin"===l&&o.length>0&&u.push("--args",...o);const d=s.spawn(r,u,w);return e.wait?new Promise(((r,t)=>{d.once("error",t),d.once("close",(o=>{e.allowNonzeroExitCode&&o>0?t(new Error(`Exited with code ${o}`)):r(d)}))})):(d.unref(),d)},d=(e,r)=>{if("string"!=typeof e)throw new TypeError("Expected a `target`");return m({...r,target:e})};function h(e){if("string"==typeof e||Array.isArray(e))return e;const{[w]:r}=e;if(!r)throw new Error(`${w} is not supported`);return r}function x({[l]:e},{wsl:r}){if(r&&a)return h(r);if(!e)throw new Error(`${l} is not supported`);return h(e)}const y={};u(y,"chrome",(()=>x({darwin:"google chrome",win32:"chrome",linux:["google-chrome","google-chrome-stable","chromium"]},{wsl:{ia32:"/mnt/c/Program Files (x86)/Google/Chrome/Application/chrome.exe",x64:["/mnt/c/Program Files/Google/Chrome/Application/chrome.exe","/mnt/c/Program Files (x86)/Google/Chrome/Application/chrome.exe"]}}))),u(y,"firefox",(()=>x({darwin:"firefox",win32:"C:\\Program Files\\Mozilla Firefox\\firefox.exe",linux:"firefox"},{wsl:"/mnt/c/Program Files/Mozilla Firefox/firefox.exe"}))),u(y,"edge",(()=>x({darwin:"microsoft edge",win32:"msedge",linux:["microsoft-edge","microsoft-edge-dev"]},{wsl:"/mnt/c/Program Files (x86)/Microsoft/Edge/Application/msedge.exe"}))),d.apps=y,d.openApp=(e,r)=>{if("string"!=typeof e)throw new TypeError("Expected a `name`");const{arguments:t=[]}=r||{};if(null!=t&&!Array.isArray(t))throw new TypeError("Expected `appArguments` as Array type");return m({...r,app:{name:e,arguments:t}})},e.exports=d},81:e=>{"use strict";e.exports=require("child_process")},147:e=>{"use strict";e.exports=require("fs")},292:e=>{"use strict";e.exports=require("fs/promises")},37:e=>{"use strict";e.exports=require("os")},17:e=>{"use strict";e.exports=require("path")}},r={};function t(o){var s=r[o];if(void 0!==s)return s.exports;var n=r[o]={exports:{}};return e[o](n,n.exports,t),n.exports}(()=>{const e=t(17),r=t(292),o=t(318),s=new RegExp("(https?://(?:www.|(?!www))[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9].[^s]{2,}|www.[a-zA-Z0-9][a-zA-Z0-9-]+[a-zA-Z0-9].[^s]{2,}|https?://(?:www.|(?!www))[a-zA-Z0-9]+.[^s]{2,}|www.[a-zA-Z0-9]+.[^s]{2,})");(async()=>{try{const[t]=process.argv.slice(2);if(!t)throw"404 - Argumentos";const n=e.resolve(__dirname,"./routes.json"),i=await r.readFile(n),a=JSON.parse(i),c=t.split(":");console.log("script args ->",c);let u=a;if(c.forEach((e=>u=u[e])),console.log("last route ->",u),!u)throw"404 - Ruta";if(s.test(u))console.log("Abriendo url..."),o(u);else{if(!s.test(u.url))throw"404 - Url";console.log("Abriendo url..."),o(u.url)}}catch(e){console.log(e)}})()})()})();